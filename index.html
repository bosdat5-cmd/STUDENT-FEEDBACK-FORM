<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Feedback Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .form-page { display: none; transition: all 0.3s ease; }
    .active-page { display: block; }
    .card { background: #fff; border-radius: 0.75rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05); padding: 2rem; margin-bottom: 2rem; }
    .btn-primary { background-color: #2563eb; color: #fff; padding: 0.6rem 1.5rem; border-radius: 0.5rem; font-weight: 600; transition: all 0.2s; }
    .btn-primary:hover { background-color: #1e40af; }
    .btn-secondary { background-color: #6b7280; color: #fff; padding: 0.6rem 1.5rem; border-radius: 0.5rem; font-weight: 600; }
    .btn-secondary:hover { background-color: #4b5563; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

  <!-- Header -->
  <div class="text-center py-6 bg-blue-900 text-white shadow-lg">
    <h1 class="text-2xl font-bold uppercase">THE INSTITUTE OF CHARTERED ACCOUNTANT OF INDIA</h1>
    <p class="text-lg mt-1">Student Feedback Form</p>
  </div>

  <div class="max-w-3xl mx-auto mt-6 bg-white p-8 rounded-2xl shadow-lg">

    <!-- Page 1: Basic Info -->
    <div id="page1" class="form-page active-page card">
      <h2 class="text-2xl font-semibold mb-4 text-blue-700">Basic Information</h2>
      <p class="text-gray-500 mb-6">Please fill in your details to proceed with feedback.</p>

      <label class="block mb-2 font-medium">Student Name <span class="text-red-500">*</span></label>
      <input id="studentName" type="text" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Your full name">

      <label class="block mb-2 font-medium">Registration Number <span class="text-red-500">*</span></label>
      <input id="regNumber" type="text" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="C/N/E/W/N/S/FRO1234567">

      <label class="block mb-2 font-medium">Email <span class="text-red-500">*</span></label>
      <input id="email" type="email" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="example@email.com">

      <label class="block mb-2 font-medium">Mobile Number <span class="text-red-500">*</span></label>
      <input id="mobile" type="tel" class="w-full p-3 border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="10 digit number">

      <div class="flex justify-end mt-6">
        <button type="button" class="btn-primary" onclick="validatePage1()">Next →</button>
      </div>
    </div>  

    <!-- Page 2: Faculty Selection -->
    <div id="page2" class="form-page card">
      <h2 class="text-2xl font-semibold mb-4 text-blue-700">Select Faculty</h2>
      <select id="facultySelect" class="w-full p-2 border rounded mb-6"></select>

      <div class="flex justify-between mt-6">
        <button type="button" class="btn-secondary" onclick="showPage(1)">← Back</button>
        <button type="button" class="btn-primary" onclick="validatePage2()">Next →</button>
      </div>
    </div>

    <!-- Page 3: Feedback -->
    <div id="page3" class="form-page card">
      <h2 class="text-2xl font-semibold mb-4 text-blue-700">Faculty Feedback</h2>

      <label class="block mb-2">Batch ID <span class="text-red-500">*</span></label>
      <input id="batchId" type="text" class="w-full p-2 border rounded mb-4">

      <div id="questionsContainer"></div>

      <label class="block mt-4 mb-2">Quiz Marks <span class="text-red-500">*</span></label>
      <input id="quizMarks" type="number" min="0" max="100" class="w-full p-2 border rounded mb-4" oninput="calculateScore()">

      <div class="p-4 bg-gray-50 rounded border mt-4">
        <p><b>Weightage Score:</b> <span id="weightageScore">0</span></p>
        <p><b>Grade:</b> <span id="grade">-</span></p>
      </div>

      <div class="flex justify-between mt-6">
        <button type="button" class="btn-secondary" onclick="showPage(2)">← Back</button>
        <button type="button" class="btn-primary" onclick="validateFeedback()">✅ Submit Feedback</button>
      </div>
    </div>

  </div>

<script>
/* ======= Cleaned JS for multi-page form ======= */

const faculties = ["Sandeep Agarwal","Bhanu Dhir","Shekhar Sharma","Anju Gupta","Preeti Goel","Rohit Agarwal","Sunita Rathore"];
let completedFaculties = [];
const questions = ["Attendance & Punctuality","Professional Dress Code","Discipline & Conduct","Active Participation","Group Activities & Teamwork","Presentation - Content","Presentation - Delivery","Communication Skills","Analytical Thinking","Creativity & Innovation","Professional Ethics Awareness","Emotional Intelligence","Overall Engagement"];

let currentPage = 1;

function showPage(n) {
  currentPage = n;
  document.querySelectorAll(".form-page").forEach(p => p.style.display = "none");
  document.getElementById("page"+n).style.display = "block";
  if(n===2) loadFaculties();
  if(n===3) loadQuestions();
}

function validatePage1() {
  const studentName = document.getElementById("studentName").value.trim();
  const regNumber = document.getElementById("regNumber").value.trim();
  const email = document.getElementById("email").value.trim();
  const mobile = document.getElementById("mobile").value.trim();

  if(!studentName || !regNumber || !email || !mobile){
    alert("⚠️ Please fill all fields!");
    return;
  }

  const regPattern = /^(CRO|NRO|FRO|SRO|ERO|WRO)\d{7}$/i;
  if(!regPattern.test(regNumber)){
    alert("⚠️ Invalid Registration Number format!");
    return;
  }

  if(!/^[6-9]\d{9}$/.test(mobile)){
    alert("⚠️ Invalid mobile number!");
    return;
  }

  if(!email.includes("@") || !email.includes(".")){
    alert("⚠️ Invalid email address!");
    return;
  }

  showPage(2);
}

function validatePage2() {
  const faculty = document.getElementById("facultySelect").value;
  if(!faculty){ alert("⚠️ Please select a faculty!"); return; }
  showPage(3);
}

function validateFeedback(){
  const batchId = document.getElementById("batchId").value.trim();
  const quizMarks = document.getElementById("quizMarks").value.trim();

  if(!batchId || quizMarks===""){ alert("⚠️ Fill Batch ID & Quiz Marks"); return; }

  const unanswered = [];
  questions.forEach((q,i)=>{
    if(!document.getElementById("q"+i)?.value) unanswered.push(i+1);
  });
  if(unanswered.length>0){ alert("⚠️ Answer all questions. Missing Qs: "+unanswered.join(",")); return; }

  // Mark faculty completed
  const faculty = document.getElementById("facultySelect").value;
  completedFaculties.push(faculty);

  alert("✅ Feedback submitted for "+faculty);

  resetFeedbackForm();

  if(completedFaculties.length<faculties.length){
    loadFaculties();
    showPage(2);
  }else{
    document.querySelectorAll(".form-page").forEach(p=>p.style.display="none");
    const container = document.querySelector(".max-w-3xl");
    const done = document.createElement("div");
    done.innerHTML = `<h2 class="text-2xl font-bold mb-4">Thank you!</h2><p>All feedback submitted.</p>`;
    container.appendChild(done);
  }
}

function loadFaculties(){
  const select = document.getElementById("facultySelect");
  select.innerHTML = "";
  const available = faculties.filter(f=>!completedFaculties.includes(f));
  if(available.length===0){
    select.innerHTML=`<option value="">No faculties left</option>`;
    select.disabled=true;
  }else{
    available.forEach(f=>{ select.innerHTML+=`<option value="${f}">${f}</option>`; });
    select.disabled=false;
  }
}

function loadQuestions(){
  const container = document.getElementById("questionsContainer");
  container.innerHTML = "";
  questions.forEach((q,i)=>{
    container.innerHTML += `<div class="mb-4">
      <label class="block mb-1">${q} <span class="text-red-500">*</span></label>
      <select id="q${i}" class="w-full p-2 border rounded" onchange="calculateScore()">
        <option value="">--Select--</option>
        <option value="20">1. POOR</option>
        <option value="40">2. BELOW AVERAGE</option>
        <option value="60">3. AVERAGE</option>
        <option value="80">4. GOOD</option>
        <option value="100">5. EXCELLENT</option>
      </select>
    </div>`;
  });
  document.getElementById("weightageScore").innerText="0.00";
  document.getElementById("grade").innerText="-";
}

function calculateScore(){
  let total=0,count=0;
  questions.forEach((q,i)=>{
    const val = parseInt(document.getElementById("q"+i)?.value||0,10);
    if(val){ total+=val; count++; }
  });
  const avg = count>0 ? total/count : 0;
  const quiz = parseFloat(document.getElementById("quizMarks")?.value||0);
  const weightage = (avg+quiz)/2;
  document.getElementById("weightageScore").innerText=weightage.toFixed(2);

  let grade="C";
  if(weightage>=85) grade="A+";
  else if(weightage>=70) grade="A";
  else if(weightage>=50) grade="B+";
  else if(weightage>=30) grade="B";
  document.getElementById("grade").innerText=grade;
}

function resetFeedbackForm(){
  document.getElementById("batchId").value="";
  document.getElementById("quizMarks").value="";
  document.getElementById("weightageScore").innerText="0.00";
  document.getElementById("grade").innerText="-";
  document.querySelectorAll("#questionsContainer select").forEach(s=>{ s.value=""; });
}

// Initialize
showPage(1);
</script>
</body>
</html>
