<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Feedback Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .form-page { display: none; }
    .form-page.active { display: block; }
  </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
  <div class="bg-white shadow-lg rounded-lg p-8 w-full max-w-xl">
    <h1 class="text-2xl font-bold mb-6 text-center">üìù Student Feedback Form</h1>

    <!-- ================= PAGE 1: BASIC INFO ================= -->
    <div class="form-page active" id="page1">
      <h2 class="text-xl font-semibold mb-4">Basic Information</h2>

      <label class="block mb-2">Student Name *</label>
      <input type="text" name="studentName" id="studentName"
             class="w-full p-2 border rounded mb-4" required>

      <label class="block mb-2">Registration Number *</label>
      <input type="text" name="regNumber" id="regNumber"
             class="w-full p-2 border rounded mb-4" required>

      <label class="block mb-2">Mobile Number *</label>
      <input type="text" name="mobile" id="mobile"
             placeholder="10 digits, starts with 6-9"
             class="w-full p-2 border rounded mb-4" required>

      <label class="block mb-2">Email ID *</label>
      <input type="email" name="email" id="email"
             class="w-full p-2 border rounded mb-4" required>

      <button type="button" id="nextBtn1"
              class="px-4 py-2 bg-blue-500 text-white rounded">Next</button>
    </div>

    <!-- ================= PAGE 2: FACULTY SELECTION ================= -->
    <div class="form-page" id="page2">
      <h2 class="text-xl font-semibold mb-4">Faculty Selection</h2>

      <label class="block mb-2">Select Faculty *</label>
      <select name="facultyName" id="facultyName"
              class="w-full p-2 border rounded mb-4" required>
        <option value="">-- Select Faculty --</option>
        <option value="Faculty 1">Faculty 1</option>
        <option value="Faculty 2">Faculty 2</option>
        <option value="Faculty 3">Faculty 3</option>
        <option value="Faculty 4">Faculty 4</option>
        <option value="Faculty 5">Faculty 5</option>
        <option value="Faculty 6">Faculty 6</option>
        <option value="Faculty 7">Faculty 7</option>
      </select>

      <label class="block mb-2">Batch ID *</label>
      <input type="text" name="batchId" id="batchId"
             class="w-full p-2 border rounded mb-4" required>

      <div class="flex justify-between">
        <button type="button" id="backBtn2"
                class="px-4 py-2 bg-gray-400 text-white rounded">Back</button>
        <button type="button" id="nextBtn2"
                class="px-4 py-2 bg-blue-500 text-white rounded">Next</button>
      </div>
    </div>

    <!-- ================= PAGE 3: FEEDBACK QUESTIONS ================= -->
    <div class="form-page" id="page3">
      <h2 class="text-xl font-semibold mb-4">Feedback Questions</h2>

      <div class="space-y-4">
        <label>Q1. Attendance & Punctuality</label>
        <input type="number" name="Q1" min="0" max="10"
               class="w-full p-2 border rounded">

        <label>Q2. Professional Image & Engagement</label>
        <input type="number" name="Q2" min="0" max="10"
               class="w-full p-2 border rounded">

        <label>Q3. Subject Knowledge</label>
        <input type="number" name="Q3" min="0" max="10"
               class="w-full p-2 border rounded">

        <label>Q4. Teaching Effectiveness</label>
        <input type="number" name="Q4" min="0" max="10"
               class="w-full p-2 border rounded">

        <label>Q5. Use of Teaching Aids</label>
        <input type="number" name="Q5" min="0" max="10"
               class="w-full p-2 border rounded">

        <label>Q6. Student Interaction</label>
        <input type="number" name="Q6" min="0" max="10"
               class="w-full p-2 border rounded">

        <label>Q7. Responsiveness to Queries</label>
        <input type="number" name="Q7" min="0" max="10"
               class="w-full p-2 border rounded">
      </div>

      <label class="block mb-2 mt-4">Quiz Marks (out of 100)</label>
      <input type="number" name="quizMarks" id="quizMarks"
             class="w-full p-2 border rounded">

      <div class="flex justify-between mt-6">
        <button type="button" id="backBtn3"
                class="px-4 py-2 bg-gray-400 text-white rounded">Back</button>
        <button type="button" id="nextBtn3"
                class="px-4 py-2 bg-blue-500 text-white rounded">Next</button>
      </div>
    </div>

    <!-- ================= PAGE 4: SCORE & SUBMIT ================= -->
    <div class="form-page" id="page4">
      <h2 class="text-xl font-semibold mb-4">Result & Submit</h2>

      <p><strong>Average Score:</strong> <span id="avgScore">0</span></p>
      <p><strong>Weighted Score:</strong> <span id="weightedScore">0</span></p>
      <p><strong>Grade:</strong> <span id="grade">N/A</span></p>

      <div class="flex justify-between mt-6">
        <button type="button" id="backBtn4"
                class="px-4 py-2 bg-gray-400 text-white rounded">Back</button>
        <button type="button" id="submitBtn"
                class="px-4 py-2 bg-green-500 text-white rounded">Submit</button>
      </div>
    </div>

    <!-- ================= RESULT ================= -->
    <div class="form-page" id="thankyouPage">
      <h2 class="text-xl font-bold text-center text-green-600">‚úÖ Thank You!</h2>
      <p class="text-center mt-4">Your feedback has been submitted successfully.</p>
    </div>
  </div>

  <script>
    // Switch pages
    const pages = document.querySelectorAll(".form-page");
    let currentPage = 0;
    function showPage(index) {
      pages.forEach((page, i) => page.classList.toggle("active", i === index));
      currentPage = index;
    }

    document.getElementById("nextBtn1").onclick = () => showPage(1);
    document.getElementById("backBtn2").onclick = () => showPage(0);
    document.getElementById("nextBtn2").onclick = () => showPage(2);
    document.getElementById("backBtn3").onclick = () => showPage(1);
    document.getElementById("nextBtn3").onclick = () => {
      calculateScores();
      showPage(3);
    };
    document.getElementById("backBtn4").onclick = () => showPage(2);

    // Calculate average, weighted score, grade
    function calculateScores() {
      const qScores = Array.from(document.querySelectorAll("[name^=Q]")).map(el => Number(el.value) || 0);
      const quiz = Number(document.getElementById("quizMarks").value) || 0;
      const avg = qScores.reduce((a,b)=>a+b,0) / qScores.length;
      const weighted = (avg * 10 + quiz) / 2; // simple weighting example
      let grade = "F";
      if (weighted >= 85) grade = "A";
      else if (weighted >= 70) grade = "B";
      else if (weighted >= 50) grade = "C";
      else grade = "D";

      document.getElementById("avgScore").innerText = avg.toFixed(2);
      document.getElementById("weightedScore").innerText = weighted.toFixed(2);
      document.getElementById("grade").innerText = grade;
    }

    // Submit to Google Apps Script
    document.getElementById("submitBtn").onclick = () => {
      const formData = {};
      document.querySelectorAll("input, select").forEach(el => {
        formData[el.name] = el.value;
      });
      formData["averageScore"] = document.getElementById("avgScore").innerText;
      formData["weightedScore"] = document.getElementById("weightedScore").innerText;
      formData["grade"] = document.getElementById("grade").innerText;

      fetch("https://script.google.com/macros/s/AKfycby-pecNA2iTiza8agKnLJ2qlXtFS3zZNZD-M3cWe4Ch23hbGUD-HTwzDoFqVHkw7WAM/exec", {
        method: "POST",
        body: JSON.stringify(formData)
      })
      .then(res => res.text())
      .then(() => showPage(4))
      .catch(err => alert("Failed: " + err.message));
    };
  </script>
</body>
</html>

