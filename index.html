<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Faculty Self-Evaluation Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .form-page { display: none; transition: all 0.3s ease; }
    .active-page { display: block; }
    .card { background: #fff; border-radius: 0.75rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05); padding: 2rem; margin-bottom: 2rem; }
    .btn-primary { background-color: #2563eb; color: #fff; padding: 0.6rem 1.5rem; border-radius: 0.5rem; font-weight: 600; transition: all 0.2s; }
    .btn-primary:hover { background-color: #1e40af; }
    .btn-secondary { background-color: #6b7280; color: #fff; padding: 0.6rem 1.5rem; border-radius: 0.5rem; font-weight: 600; }
    .btn-secondary:hover { background-color: #4b5563; }
  </style>
</head>
<body class="bg-gray-100">

  <div class="max-w-3xl mx-auto mt-8">
    <h1 class="text-2xl font-bold text-center text-blue-700 mb-2">
      THE INSTITUTE OF CHARTERED ACCOUNTANTS OF INDIA
    </h1>
    <h2 class="text-lg font-semibold text-center text-gray-700 mb-6">
      Faculty Self-Evaluation Form ‚Äì Chartered Accountancy Educators
    </h2>

    <!-- Page 0: Upload Excel -->
    <div id="page0" class="form-page active-page card">
      <label class="block mb-2 font-medium">üì• Download Template</label>
      <button class="btn-primary mb-4" onclick="downloadTemplate()">Download Excel Template</button>

      <label class="block mb-2 font-medium">üì§ Upload Student Excel</label>
      <input type="file" id="excelFile" accept=".xlsx" onchange="uploadExcel(event)" class="mb-4">

      <label class="block mb-2 font-medium">Select SRN *</label>
      <select id="srnDropdown" class="w-full border p-2 rounded"></select>

      <div class="text-right mt-6">
        <button class="btn-primary" onclick="startFeedback()">Start ‚Üí</button>
      </div>
    </div>

    <!-- Page 1: Basic Info -->
    <div id="page1" class="form-page card">
      <h3 class="text-xl font-semibold text-blue-600 mb-4">Basic Information</h3>
      <label>Name *</label>
      <input type="text" id="name" class="border p-2 rounded w-full mb-3">

      <label>Subject(s) Taught *</label>
      <input type="text" id="subject" class="border p-2 rounded w-full mb-3">

      <label>Institution/Academy *</label>
      <input type="text" id="institution" class="border p-2 rounded w-full mb-3">

      <label>Period of Evaluation *</label>
      <input type="text" id="period" class="border p-2 rounded w-full mb-3">

      <div class="text-right">
        <button class="btn-primary" onclick="showPage(2)">Next ‚Üí</button>
      </div>
    </div>

    <!-- Page 2: Teaching Effectiveness -->
    <div id="page2" class="form-page card">
      <h3 class="text-xl font-semibold text-blue-600 mb-4">Teaching Effectiveness</h3>
      <div id="questionsContainer"></div>
      <div class="text-right">
        <button class="btn-secondary" onclick="showPage(1)">‚Üê Back</button>
        <button class="btn-primary" onclick="showPage(3)">Next ‚Üí</button>
      </div>
    </div>

    <!-- Page 3: Student Impact -->
    <div id="page3" class="form-page card">
      <h3 class="text-xl font-semibold text-blue-600 mb-4">Student Impact</h3>
      <label>Approx. number of students taught</label>
      <input type="text" class="border p-2 rounded w-full mb-3">

      <label>Number of students who passed/qualified</label>
      <input type="text" class="border p-2 rounded w-full mb-3">

      <label>Notable student success stories</label>
      <textarea rows="3" class="border p-2 rounded w-full mb-3"></textarea>

      <div class="text-right">
        <button class="btn-secondary" onclick="showPage(2)">‚Üê Back</button>
        <button class="btn-primary" onclick="showPage(4)">Next ‚Üí</button>
      </div>
    </div>

    <!-- ... Pages 4,5,6 (Professional Development, Contribution, Reflection, Additional Comments) ... -->
    <!-- For brevity, same pattern as above -->

    <!-- Page 8: Thank You -->
    <div id="page8" class="form-page card">
      <h3 class="text-xl font-semibold text-green-600 text-center">üéâ Thank you for your valuable feedback!</h3>
    </div>
  </div>

<script>
let students = [];
let currentSRN = null;

// Download Excel template
function downloadTemplate() {
  const ws_data = [["S.No","SRN","Name"],["1","SRN001","John Doe"]];
  const ws = XLSX.utils.aoa_to_sheet(ws_data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Template");
  XLSX.writeFile(wb, "StudentTemplate.xlsx");
}

// Upload Excel
function uploadExcel(event) {
  const file = event.target.files[0];
  const reader = new FileReader();
  reader.onload = (e) => {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: "array" });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    students = XLSX.utils.sheet_to_json(sheet);

    let dropdown = document.getElementById("srnDropdown");
    dropdown.innerHTML = "";
    students.forEach(s => {
      if(s.SRN) dropdown.innerHTML += `<option value="${s.SRN}">${s.SRN} - ${s.Name}</option>`;
    });
  };
  reader.readAsArrayBuffer(file);
}

function startFeedback() {
  const dropdown = document.getElementById("srnDropdown");
  if(!dropdown.value){ alert("‚ö† Please select an SRN"); return; }
  currentSRN = dropdown.value;
  loadQuestions();
  showPage(1);
}

function loadQuestions() {
  const qList = [
    "Subject knowledge and updates",
    "Clarity in explanation",
    "Use of examples & case studies",
    "Engagement with students",
    "Responsiveness to queries",
    "Integration of values & ethics",
    "Use of technology/tools"
  ];
  let container = document.getElementById("questionsContainer");
  container.innerHTML = "";
  qList.forEach((q,i)=>{
    container.innerHTML += `
      <label>${q}</label>
      <select class="border p-2 rounded w-full mb-3">
        <option value="">--Select--</option>
        <option value="1">1. Poor</option>
        <option value="2">2. Below Average</option>
        <option value="3">3. Average</option>
        <option value="4">4. Good</option>
        <option value="5">5. Excellent</option>
      </select>
      <textarea placeholder="Optional comments..." class="border p-2 rounded w-full mb-3"></textarea>
    `;
  });
}

function showPage(n) {
  document.querySelectorAll(".form-page").forEach(p => p.classList.remove("active-page"));
  document.getElementById("page"+n).classList.add("active-page");
}
</script>
</body>
</html>
